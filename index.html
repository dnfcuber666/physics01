<!DOCTYPE html>


function update() {
ctx.clearRect(0, 0, canvas.width, canvas.height);
let pressure = 0;
for (let p of particles) {
p.x += p.vx;
p.y += p.vy;


// 左右牆碰撞
if (p.x - p.radius < 0) {
pressure += Math.abs(2 * p.vx);
p.vx *= -1;
}
if (p.x + p.radius > canvas.width) {
pressure += Math.abs(2 * p.vx);
p.vx *= -1;
}


// 上下牆碰撞
if (p.y - p.radius < 0) {
pressure += Math.abs(2 * p.vy);
p.vy *= -1;
}
if (p.y + p.radius > canvas.height) {
pressure += Math.abs(2 * p.vy);
p.vy *= -1;
}


ctx.beginPath();
ctx.arc(p.x, p.y, p.radius, 0, 2*Math.PI);
ctx.fill();
}


// 2D 容器總周長
let containerLength = 2 * (canvas.width + canvas.height);
let P = pressure / containerLength;
pressureEl.textContent = P.toFixed(2);


computeStats();
if (running) requestAnimationFrame(update);
}


document.getElementById("startBtn").onclick = () => {
if (!running) {
initialTemp = parseFloat(tempInput.value);
tempInput.disabled = true;
initParticles();
running = true;
update();
}
};


document.getElementById("resetBtn").onclick = () => {
running = false;
tempInput.disabled = false;
initParticles();
ctx.clearRect(0, 0, canvas.width, canvas.height);
avgSpeedEl.textContent = "0";
temperatureEl.textContent = "0";
pressureEl.textContent = "0";
};


initParticles();
</script>
</body>
</html>
